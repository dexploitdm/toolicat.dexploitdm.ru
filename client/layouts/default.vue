<template>
    <div v-bind:class="{'modal-win': stateModalLayout}"
        class="wrapper">
        <top-nav/>
        <mobile-menu/>
        <main>
            <nuxt/>
        </main>
        <footer-box/>
    </div>
</template>

<script>
    import TopNav from "./partials/TopNav";
    import MobileMenu from "~/components/base/header/mobileMenu.vue";
    import FooterBox from "./partials/FooterBox";

    export default {
        components: {
            TopNav,
            MobileMenu,
            FooterBox
        },
        data(){
            return {
                servicesData: [],
                catalogsData: [],
            }
        },
        created() {
            this.$store.dispatch('data/users/GET_USER')
            this.$store.dispatch('data/category/GET_CATEGORIES')
            this.$store.dispatch('data/services/GET_SERVICES')
        },
        methods: {
            redirectServiceTO() {
                if(this.redirectService){
                    setTimeout(() => {
                        this.$router.push("/services/" + this.redirectService).catch(()=>{});
                        }, 1000);
                }
            },
        },
        watch: {
            services () {
                this.servicesData = this.services;
            },
            redirectService(){
                this.redirectServiceTO()
            }
        },
        computed: {
            services() {
                return this.$store.state.data.services.services;
            },
            stateModalLayout() {
                return this.$store.state.others.modals.modalLayout;
            },
            redirectService() {
                return this.$store.state.others.redirect.afterAuthReview;
            },
        }
    };
</script>

<style lang="scss">
    @import "~assets/scss/site.scss";
</style>
