<template>
    <div class="page content">
        <div class="title-box">
            <h1 class="title-h1">Бесплатно добавим ваш сервис в каталог</h1>
        </div>
        <div class="page-box">
            <div class="cr-service">
                <el-steps :active="active">
                    <el-step></el-step>
                    <el-step></el-step>
                    <el-step></el-step>
                </el-steps>
                <form @submit="formSubmit" enctype="multipart/form-data">
                <div class="step-box" v-if="active === 0">
                    <h2 class="title-h2">О компании</h2>

                    <div class="cr-service-form">
                        <div class="t-control box-control">
                            <span class="t-label">Название сервиса*</span>
                            <input type="text" class="t-input" v-model="title" />
                        </div>
                        <div class="t-control box-control">
                            <span class="t-label">Ссылка на ваш сервис или программу*</span>
                            <input type="text" class="t-input" v-model="linkSite" />
                        </div>
                        <div class="t-control box-control">
                            <span class="t-label">Ваше имя*</span>
                            <input type="text" class="t-input" v-model="name" />
                        </div>
                        <div class="t-control box-control">
                            <span class="t-label">Ваша фамилия*</span>
                            <input type="text" class="t-input" v-model="surname" />
                        </div>
                        <div class="t-control box-control">
                            <span class="t-label">Email на домене вашего сервиса*</span>
                            <input type="text" class="t-input" v-model="email" />
                        </div>
                    </div>


                </div>

                <div class="step-box" v-if="active === 1">
                    <h2 class="title-h2">О продукте</h2>
                    <div class="cr-service-form">

                        <div class="t-control box-control">
                            <span class="t-label">Категория*</span>
                            <el-select
                                v-model="category_id"
                                multiple
                                filterable
                                allow-create
                                default-first-option
                                placeholder="Выбрать категорию"
                                class="t-select">
                                <el-option
                                    v-for="item in categories"
                                    :key="item.id"
                                    :label="item.title"
                                    :value="item.id">
                                </el-option>
                            </el-select>
                        </div>
                        <div class="t-control box-control">
                            <span class="t-label">Описание *</span>
                            <el-input
                                type="textarea"
                                :rows="2"
                                :autosize="{ minRows: 5, maxRows: 6}"
                                v-model="content">
                            </el-input>
                        </div>
                        <div class="control-flex">
                            <div class="t-control box-control">
                                <span class="t-label">Видео</span>
                                <input type="text"
                                       class="t-input"
                                       placeholder="Ссылка на видео"
                                       v-model="linkVideo" />
                            </div>
                            <div class="t-control t-upload upload-box">
                                <div class="t-upload-box">
                                    <div class="t-upload-icon"></div>
                                    <div class="t-upload-label">Выбрат файл</div>
                                    <div class="t-upload-btn full">Загрузить</div>
                                </div>
                            </div>
                        </div>
                        <div class="t-control t-upload box-control t-control-border">
                            <span class="t-label">Логотип</span>
                            <div class="t-upload-box">
                                <div class="t-upload-icon"></div>
                                <div class="t-upload-label">Выбрат файл</div>
                                <div class="t-upload-btn" @click="uploadLogo">Загрузить</div>
                            </div>
                            <input type="file" id="imageLogo" class="hidden" v-on:change="onImageChangeLogo" />
                        </div>
                        <div class="t-control t-upload box-control t-control-border">
                            <span class="t-label">Интерфейс <span class="t-label_small">(скрины продукта)</span></span>
                            <div class="t-upload-box">
                                <div class="t-upload-icon"></div>
                                <div class="t-upload-label">Выбрат файл</div>
                                <div class="t-upload-btn" @click="uploadImages">Загрузить</div>
                            </div>
                            <input type="file" id="interface" class="hidden" v-on:change="onImageChange" multiple />
                        </div>
                        <div class="t-control box-control">
                            <span class="t-label">Пробный период</span>
                            <el-checkbox v-model="testPeriod">
                                <span v-if="testPeriod === true">Да</span>
                                <span v-else>Нет</span>
                            </el-checkbox>
                        </div>

                        <div class="t-control box-control" v-if="testPeriod">
                            <span class="t-label">Пробный период*</span>
                            <div class="grid g-two">
                                <el-date-picker
                                    v-model="testPeriodDate"
                                    type="date"
                                    placeholder="Указать дату"
                                    class="date-control">
                                </el-date-picker>
                                <input type="text"
                                       class="t-input"
                                       placeholder="Ссылка на пробный период"
                                       v-model="testPeriodLink" />
                            </div>
                        </div>
                        <div class="t-control box-control">
                            <span class="t-label">Цена*</span>
                            <div class="grid g-two">
                                <div class="t-flex-control">
                                    <span class="t-label_small">от</span>
                                    <input type="text" class="t-input" v-model="priceStart" />
                                </div>
                                <div class="t-flex-control">
                                    <span class="t-label_small">до</span>
                                    <input type="text" class="t-input" v-model="priceEnd" />
                                </div>
                            </div>

                        </div>
                        <div class="t-control box-control">
                            <span class="t-label">Доступные языки</span>
                            <el-select
                                v-model="languages"
                                multiple
                                filterable
                                allow-create
                                default-first-option
                                placeholder="Выберите"
                                class="t-select gray">
                                <el-option
                                    v-for="item in languagesItems"
                                    :key="item.value"
                                    :label="item.label"
                                    :value="item.value">
                                </el-option>
                            </el-select>
                        </div>
                        <div class="t-control box-control">
                            <span class="t-label">Для кого*</span>
                            <div class="box-control-child">
                                <span class="t-label label-t1">Бизнес:</span>
                                <el-checkbox-group v-model="business">
                                    <el-checkbox label="Маленький"></el-checkbox>
                                    <el-checkbox label="Большой"></el-checkbox>
                                    <el-checkbox label="Крупный"></el-checkbox>
                                </el-checkbox-group>
                            </div>
                            <div class="box-control-child">
                                <span class="t-label label-t1">Бизнес для:</span>
                                <el-checkbox-group v-model="businessFor">
                                    <el-checkbox label="Бизнеса"></el-checkbox>
                                    <el-checkbox label="Потребителя"></el-checkbox>
                                </el-checkbox-group>
                            </div>
                            <el-select
                                v-model="ProductWhom"
                                multiple
                                filterable
                                allow-create
                                default-first-option
                                placeholder="Добавьте ключевые слова"
                                class="t-select many">
                                <el-option
                                    v-for="item in whom"
                                    :key="item.value"
                                    :label="item.label"
                                    :value="item.value">
                                </el-option>
                            </el-select>
                        </div>
                    </div>
                </div>

                <div class="step-box" v-if="active === 2">
                    <h2 class="title-h2">Завершение</h2>
                    <div class="cr-service-form">
                        <div class="t-control box-control">
                            <span class="t-label">Система на которую устанавливается</span>
                            <el-select
                                v-model="ProductSystem"
                                multiple
                                filterable
                                default-first-option
                                placeholder="Выбрать"
                                class="t-select">
                                <el-option
                                    v-for="item in systemInstallAll"
                                    :key="item.value"
                                    :label="item.label"
                                    :value="item.value">
                                </el-option>
                            </el-select>
                        </div>
                        <div class="t-control box-control">
                            <span class="t-label">Особенности и возможности</span>
                            <input type="text" class="t-input" v-model="ProductFeatures" />
                        </div>
                        <div class="t-control box-control">
                            <span class="t-label">Поддержка</span>
                            <el-radio v-model="ProductSupport" class="check" label="1">Есть</el-radio>
                            <el-radio v-model="ProductSupport" class="check" label="2">Нету</el-radio>
                        </div>
                        <div class="t-control box-control">
                            <span class="t-label">Кейсы</span>
                            <input type="text" class="t-input" placeholder="Вставьте ссылку"
                                   v-model="ProductKeysLink" />
                        </div>
                        <div class="t-control box-control">
                            <span class="t-label">Инструкция по использованию</span>
                            <input type="text" class="t-input" placeholder="Вставьте ссылку"
                                   v-model="ProductInstructionLink" />
                        </div>
                        <div class="t-control box-control">
                            <span class="t-label">API</span>
                            <input type="text" class="t-input" placeholder="Вставьте ссылку"
                                   v-model="ProductApiLink" />
                        </div>
                        <div class="t-control box-control">
                            <span class="t-label">Социальные сети</span>
                            <input type="text" class="t-input" v-model="ProductSocial" />
                        </div>

                    </div>
                </div>

                <div class="step-action">
                    <button type="button" class="t-button t-next"  @click="next">Далее</button>
                </div>
                </form>
            </div>
        </div>
    </div>
</template>

<script>
    import axios from "axios";
    export default {
        name: "create-service",
        data() {
            return {
                active: 0,
                title: '',
                linkSite: '',
                name: '',
                surname: '',
                email: '',

                category_id: [],
                image1: [],
                logo: '',

                content: '',
                linkVideo: '',
                testPeriod: '',
                testPeriodDate: '',
                testPeriodLink: '',
                priceStart: '',
                priceEnd: '',
                languages: [],
                languagesItems: [{
                    value: 'russian', label: 'Русский'},
                    {value: 'english', label: 'Английский'}],
                business: [],
                businessFor: [],


                ProductWhom: '',
                whom: [{
                    value: 'cat1', label: 'Менеджер'},
                    {value: 'cat2', label: 'Малый бизнес'}],

                ProductSystem: '',

                ProductFeatures: '',
                ProductSupport: '',
                ProductKeysLink: '',
                ProductInstructionLink: '',
                ProductApiLink: '',
                ProductSocial: ''

            }
        },
        methods: {
            formSubmit(e) {
                e.preventDefault();
                let currentObj = this;
                const config = {
                    headers: { 'content-type': 'multipart/form-data' }
                }
                let formData = new FormData();
                formData.append('title', this.title);
                formData.append('linkSite', this.linkSite);
                formData.append('name', this.name);
                formData.append('surname', this.surname);
                formData.append('email', this.email);
                formData.append('category_id', this.category_id);
                formData.append('content', this.content);
                formData.append('linkVideo', this.linkVideo);
                formData.append('logo', this.logo);
                formData.append('testPeriodDate', this.testPeriodDate);
                formData.append('testPeriodLink', this.testPeriodLink);

                formData.append('priceStart', this.priceStart);
                formData.append('priceEnd', this.priceEnd);
                formData.append('languages', this.languages);
                formData.append('business', this.business);
                formData.append('businessFor', this.businessFor);

            },
            next() {
                if(this.active === 0){
                    //company

                }
                if(this.active === 1){
                    //product

                }
                if(this.active === 2){
                    //finish step
                    console.log('push')
                }
                if (this.active++ > 2) this.active = 0;
            },
            uploadImages(){
                const actionUpload = document.getElementById('interface');
                actionUpload.click();
            },
            uploadLogo(){
                const actionUploadLogo = document.getElementById('imageLogo');
                actionUploadLogo.click();
            },
            onImageChange(e){
                for (let i=0; i<e.target.files.length; i++) {
                    this.image1.push(e.target.files[i])
                }
            },
            onImageChangeLogo(e){
                this.logo = e.target.files[0];
            }
        },
        mounted() {
            this.$store.dispatch('data/category/GET_CATEGORIES')
        },
        computed: {
            categories() {
                return this.$store.state.data.category.categories;
            },
            systemInstallAll() {
                return this.$store.state.data.others.systemInstall;
            }
        }
    }
</script>

<style scoped>

</style>
