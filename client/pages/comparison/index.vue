<template>
    <div class="comparison-page">
        <div class="comparison-title">
            <div class="container">
                <h1>
                    <span v-for="(item, index) in compareData">
                        <span v-if="index === 0">{{item.title}} </span>
                        <span v-else class="compare-vs"> vs {{item.title}}</span>
                    </span>
                </h1>
            </div>
        </div>
        <div class="container">
            {{compareData}}
            <div class="comparison-slider--content">
                <div class="comparison-slider--left">
                    <div class="price left-box--el">
                        <p>Цена</p>
                    </div>
                    <div class="for-whom left-box--el">
                        <p>Для кого?</p>
                    </div>
                    <div class="rating left-box--el">
                        <p>Рейтинг</p>
                    </div>
                    <div class="convenience left-box--el">
                        <p>Удобство</p>
                    </div>
                    <div class="opportunities left-box--el" :class="{ 'is-active': listBox1 }">
                        <p>Возможности</p>
                    </div>
                    <div class="platforms left-box--el">
                        <p>Платформы</p>
                    </div>
                    <div class="interface left-box--el">
                        <p>Интерфейс</p>
                    </div>
                </div>
                <div class="comparison-slider--right">
                    <div class="comparison-slider--scroll">

                        <div v-for="(item, index) in compareData"
                             class="comparison-slider-el">

                            <div class="top-box">
                                <div class="img-box">
                                    <img v-if="item.logo" :src="urlImage + 'services/' + item.logo" />
                                    <img v-else src="/images/others/notimage.png">
                                </div>
                                <p>{{item.title}}</p>
                                <a :href="item.linkSite" target="_blank">Сайт</a>
                            </div>
                            <div class="price">
                                <h5>Цена</h5>
                                <p>{{item.priceStart}}</p>
                            </div>
                            <div class="for-whom--content">
                                <h5>Для кого?</h5>
                                <div v-html="formatProf(item.professions)"></div>
                            </div>
                            <div class="star-box">
                                <h5>Рейтинг</h5>
                                <div  class="el-rate">
                                    <el-rate
                                        v-model="item.assessmentRecommend"
                                        disabled
                                        :colors="colors">
                                    </el-rate>
                                </div>
                            </div>
                            <div class="rating">
                                <h5>Удобство</h5>
                                <p>{{item.assessmentRecommend}}.0/5</p>
                            </div>
                            <div class="opportunities-list">
                                <h5>Возможности</h5>

                                <div class="list-container" v-for="(list, index) in item.features">
                                    <h4 @click="openList(list.id + '_' + item.id)" :id="'list_' + list.id + '_' + item.id">{{list.title}}</h4>
                                    <div :class="'list_' + list.id + '_' + item.id" class="lists">
                                        <div v-if="list.desc">
                                            {{list.desc}}
                                        </div>
                                       <ul v-else>
                                           <li class="approved-el" v-for="el in list.list">{{el}}</li>
                                       </ul>

<!--                                        <li class="close-el">Требуемая работа</li>-->
<!--                                        <li class="approved-el">Вводный</li>-->
<!--                                        <li class="close-el">Рекрутинговые Фирмы</li>-->
<!--                                        <li class="approved-el">Проверка ссылок</li>-->
<!--                                        <li class="approved-el">Возобновить анализ</li>-->
                                    </div>
                                </div>

                            </div>
                            <div class="platform-box">
                                <h5>Платформы</h5>
                                <ul :class="classPlatform(item.systemInstall)">
                                    <li class="windows-e close-el"> Windows</li>
                                    <li class="apple-e close-el">Mac</li>
                                    <li class="linux-e close-el">Linux</li>
                                    <li class="web-e close-el">Web</li>
                                    <li class="cloud-e close-el">Cloud</li>
                                    <li class="IOS-e close-el">IOS</li>
                                    <li class="android-e close-el">Android</li>
                                </ul>
                            </div>
                            <div class="interface-img">
                                <h5>Интерфейс</h5>
                                <div class="img-box">
                                    <img v-if="item.image0" :src="urlImage + 'services/items/' + item.image0" alt="img" @click="openImage(item.image0)">
                                    <img v-else-if="item.image1" :src="urlImage + 'services/items/' + item.image1" alt="img" @click="openImage(item.image1)">
                                    <img v-else-if="item.image2" :src="urlImage + 'services/items/' + item.image2" alt="img" @click="openImage(item.image2)">
                                    <img v-else src="/images/others/notimage.png">
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div v-if="stateModalImage"
             class="modal-block modal-image">
            <div class="modal-block-layout">
                <div @click="triggerModalImage"
                     class="modal-block-close"></div>
                <div class="modal-block-image">
                    <img :src="urlImage + 'services/items/' + activeModalImage" />
                </div>

            </div>
        </div>

    </div>
</template>

<script>
    const baseUrlUploads = process.env.baseUrlImage;
    export default {
        name: "index_comparison",
        data(){
            return{
                urlImage: baseUrlUploads,
                colors: ['#99A9BF', '#F7BA2A', '#FF9900'],
                activeModalImage: '',
                listBox1:false,
                listBox2:false,
                listBox3:false,
                listBox4:false,
            }
        },
        methods: {
            getCats(data){
                if(!data.length){
                    this.$router.push('/catalogs')
                }
            },
            openList(id){
                const itemList = document.getElementById('list_' + id);
                let listes = itemList.parentNode.lastElementChild;
                itemList.classList.toggle('is-active');
                listes.classList.toggle('is-active')
            },
            classPlatform(install){
                let data = this.formatData(install, 'install');
                let classBlock = '';
                for (let t = 0; t < data.length; t++) {
                    classBlock+= ' ' +data[t]
                }
                return classBlock;
            },
            openImage(image){
                this.$store.dispatch('others/modals/SET_MODAL_IMAIGE');
                this.activeModalImage = image;
            },
            triggerModalImage() {
                this.$store.dispatch('others/modals/SET_MODAL_IMAIGE');
            },
            formatProf(arr){
                let data = this.formatData(arr, 'prof');
                let htmlBlock = '';
                for (let t = 0; t < data.length; t++) {
                    htmlBlock+= '<p>' +data[t]+ '</p>'
                }
                return htmlBlock
            },
            formatData(arr, type){
                let mas = [],
                    result = [],
                    j = 0;
                for (let i = 0; i < arr.length; i++) {
                    if (arr[i] == ",") { j++; continue; }
                    else {
                        mas[j] ? mas[j] += arr[i] : mas[j] = arr[i];
                    }
                }
                if(type === 'prof'){
                    result = mas;
                } else if(type === 'install') {
                    result = mas;
                }
                return result;
            },
            // interfacePreviews(service){
            //     let result = '';
            //     console.log(service)
            //     for (let t = 0; t < 10; t++) {
            //
            //         console.log(service.image + t )
            //     }
            //
            // }
        },

        mounted() {
            let data = this.$store.state.data.compare.compareData;
            this.getCats(data);
        },
        computed: {
            compareData() {
                return this.$store.state.data.compare.compareData;
            },
            stateModalImage() {
                return this.$store.state.others.modals.modalImage;
            },
        }
    }
</script>

<style scoped>

</style>
