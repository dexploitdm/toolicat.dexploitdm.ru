<template>
    <div class="comparison-page">
        <div class="comparison-title">
            <div class="container">
                <h1>
                    <span v-for="(item, index) in compareData">
                        <span v-if="index === 0">{{item.title}} </span>
                        <span v-else class="compare-vs"> vs {{item.title}}</span>
                    </span>
                </h1>
            </div>
        </div>
        <div class="container">
            {{compareData}}
            <div class="comparison-slider--content">
                <div class="comparison-slider--left">
                    <div class="price left-box--el">
                        <p>Цена</p>
                    </div>
                    <div class="for-whom left-box--el">
                        <p>Для кого?</p>
                    </div>
                    <div class="rating left-box--el">
                        <p>Рейтинг</p>
                    </div>
                    <div class="convenience left-box--el">
                        <p>Удобство</p>
                    </div>
                    <div class="opportunities left-box--el" :class="{ 'is-active': listBox1 }">
                        <p>Возможности</p>
                    </div>
                    <div class="platforms left-box--el">
                        <p>Платформы</p>
                    </div>
                    <div class="interface left-box--el">
                        <p>Интерфейс</p>
                    </div>
                </div>
                <div class="comparison-slider--right">
                    <div class="comparison-slider--scroll">

                        <div v-for="(item, index) in compareData"
                             class="comparison-slider-el">

                            <div class="top-box">
                                <div class="img-box">
                                    <img v-if="item.logo" :src="urlImage + 'services/' + item.logo" />
                                    <img v-else src="/images/others/notimage.png">
                                </div>
                                <p>{{item.title}}</p>
                                <a :href="item.linkSite">Сайт</a>
                            </div>
                            <div class="price">
                                <h5>Цена</h5>
                                <p>{{item.priceStart}}</p>
                            </div>
                            <div class="for-whom--content">
                                <h5>Для кого?</h5>
<!--                                TODO: сформировать-->
                                <p :id="'professions'+ item.id"></p>
<!--                                {{item.professions | formatProf}}-->
                                <div v-html="formatProf(item.professions, item.id)"></div>
                            </div>
                            <div class="star-box">
                                <h5>Рейтинг</h5>
                                <div  class="el-rate">
                                    <el-rate
                                        v-model="item.assessmentRecommend"
                                        disabled
                                        :colors="colors">
                                    </el-rate>
                                </div>
                            </div>
                            <div class="rating">
                                <h5>Удобство</h5>
                                <p>4.0/5</p>
                            </div>
                            <div class="opportunities-list">
                                <h5>Возможности</h5>

                                <div class="list-container" v-for="(list, index) in item.features">
                                    <h4 @click="openList(list.id + '_' + item.id)" :id="'list_' + list.id + '_' + item.id">{{list.title}}</h4>
                                    <ul :class="'list_' + list.id + '_' + item.id">
                                        <li class="question approved-el">Объявление о вакансии</li>
                                        <li class="close-el">Требуемая работа</li>
                                        <li class="approved-el">Вводный</li>
                                        <li class="close-el">Рекрутинговые Фирмы</li>
                                        <li class="approved-el">Проверка ссылок</li>
                                        <li class="approved-el">Возобновить анализ</li>
                                    </ul>
                                </div>

                            </div>
                            <div class="platform-box">
                                <h5>Платформы</h5>
                                <ul>
                                    <li class="approved-el"> Windows</li>
                                    <li class="close-el">Mac</li>
                                    <li class="approved-el">Linux</li>
                                    <li class="close-el">Web</li>
                                </ul>
                            </div>
                            <div class="interface-img">
                                <h5>Интерфейс</h5>
                                <div class="img-box">
                                    <img src="images/img-sliders.jpg" alt="img">
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
</template>

<script>
    const baseUrlUploads = process.env.baseUrlImage;
    export default {
        name: "index_comparison",
        data(){
            return{
                urlImage: baseUrlUploads,
                colors: ['#99A9BF', '#F7BA2A', '#FF9900'],
                listBox1:false,
                listBox2:false,
                listBox3:false,
                listBox4:false,
            }
        },
        methods: {
            getCats(data){
                if(!data.length){
                    this.$router.push('/catalogs')
                }
            },
            openList(id){
                const itemList = document.getElementById('list_' + id);
                let listes = itemList.parentNode.lastElementChild;
                itemList.classList.toggle('is-active');
                listes.classList.toggle('is-active')
            },
            formatProf(arr, id){
                let data = this.formatData(arr);
                console.log(data)
                let htmlBlock = '';
                for (let t = 0; t < data.length; t++) {
                    htmlBlock+= '<p>' +data[t]+ '</p>'
                }
                return htmlBlock
            },
            formatData(arr){
                let mas = [],
                    j = 0;
                for (let i = 0; i < arr.length; i++) {
                    if (arr[i] == ",") { j++; continue; }
                    else {
                        mas[j] ? mas[j] += arr[i] : mas[j] = arr[i];
                    }
                }
                return mas;
            }
        },

        mounted() {
            let data = this.$store.state.data.compare.compareData;
            this.getCats(data);
        },
        computed: {
            compareData() {
                return this.$store.state.data.compare.compareData;
            }
        }
    }
</script>

<style scoped>

</style>
