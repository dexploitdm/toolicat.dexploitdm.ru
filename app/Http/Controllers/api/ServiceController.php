<?php

namespace App\Http\Controllers\api;

use Illuminate\Http\Request;
use App\Http\Controllers\Controller;
use App\Service;
use Illuminate\Support\Facades\Storage;
use Illuminate\Support\Facades\File;

class ServiceController extends Controller
{
    public function allServices() {
        $services = Service::all();
        return response()->json($services);
    }
    public function allServicesPag()
    {
        $data = Service::orderBy('id', 'desc')->paginate(10);
        return response()->json($data);
    }
    public function createService(Request $request) {
        if($request->logo){
            $extensionLogo = $request->logo->getClientOriginalExtension();
            $timestampNameLogo = microtime(true) . '.' . $extensionLogo;
            $request->logo->move(public_path('uploads/services'), $timestampNameLogo);
        }
        if($request->image0){
            $extensionImage0 = $request->image0->getClientOriginalExtension();
            $timestampNameImage0 = microtime(true) . '.' . $extensionImage0;
            $request->image0->move(public_path('uploads/services/items'), $timestampNameImage0);
        }
        if($request->image1){
            $extensionImage1 = $request->image1->getClientOriginalExtension();
            $timestampNameImage1 = microtime(true) . '.' . $extensionImage1;
            $request->image1->move(public_path('uploads/services/items'), $timestampNameImage1);
        }
        if($request->image2){
            $extensionImage2 = $request->image2->getClientOriginalExtension();
            $timestampNameImage2 = microtime(true) . '.' . $extensionImage2;
            $request->image2->move(public_path('uploads/services/items'), $timestampNameImage2);
        }
        if($request->image3){
            $extensionImage3 = $request->image3->getClientOriginalExtension();
            $timestampNameImage3 = microtime(true) . '.' . $extensionImage3;
            $request->image3->move(public_path('uploads/services/items'), $timestampNameImage3);
        }
        if($request->image4){
            $extensionImage4 = $request->image4->getClientOriginalExtension();
            $timestampNameImage4 = microtime(true) . '.' . $extensionImage4;
            $request->image4->move(public_path('uploads/services/items'), $timestampNameImage4);
        }
        if($request->image5){
            $extensionImage5 = $request->image5->getClientOriginalExtension();
            $timestampNameImage5 = microtime(true) . '.' . $extensionImage5;
            $request->image5->move(public_path('uploads/services/items'), $timestampNameImage5);
        }
        if($request->image6){
            $extensionImage6 = $request->image6->getClientOriginalExtension();
            $timestampNameImage6 = microtime(true) . '.' . $extensionImage6;
            $request->image6->move(public_path('uploads/services/items'), $timestampNameImage6);
        }
        if($request->image7){
            $extensionImage7 = $request->image7->getClientOriginalExtension();
            $timestampNameImage7 = microtime(true) . '.' . $extensionImage7;
            $request->image7->move(public_path('uploads/services/items'), $timestampNameImage7);
        }
        if($request->image8){
            $extensionImage8 = $request->image8->getClientOriginalExtension();
            $timestampNameImage8 = microtime(true) . '.' . $extensionImage8;
            $request->image8->move(public_path('uploads/services/items'), $timestampNameImage8);
        }
        if($request->image9){
            $extensionImage9 = $request->image9->getClientOriginalExtension();
            $timestampNameImage9 = microtime(true) . '.' . $extensionImage9;
            $request->image9->move(public_path('uploads/services/items'), $timestampNameImage9);
        }



        $data = new Service();
        $data->title = $request->get('title');
        $data->content = $request->get('content');
        $data->desc = $request->get('desc');
        $data->name = $request->get('name');
        $data->surname = $request->get('surname');
        $data->email = $request->get('email');
        $data->freeRate = $request->get('freeRate');
        $data->testPeriodDate = $request->get('testPeriodDate');
        $data->testPeriodLink = $request->get('testPeriodLink');
        $data->priceStart = $request->get('priceStart');
        $data->priceEnd = $request->get('priceEnd');
        $data->languages = $request->get('languages');
        $data->business = $request->get('business');
        $data->businessFor = $request->get('businessFor');
        $data->industries = $request->get('industries');
        //$data->features = $request->get('features');
        $data->features = json_decode($request->get('features'));
        //json_encode($request->features);

        if($request->logo){
            $data->logo = $timestampNameLogo;
        }
        if($request->image0){
            $data->image0 = $timestampNameImage0;
        }
        if($request->image1){
            $data->image1 = $timestampNameImage1;
        }
        if($request->image2){
            $data->image2 = $timestampNameImage2;
        }
        if($request->image3){
            $data->image3 = $timestampNameImage3;
        }
        if($request->image4){
            $data->image4 = $timestampNameImage4;
        }
        if($request->image5){
            $data->image5 = $timestampNameImage5;
        }
        if($request->image6){
            $data->image6 = $timestampNameImage6;
        }
        if($request->image7){
            $data->image7 = $timestampNameImage7;
        }
        if($request->image8){
            $data->image8 = $timestampNameImage8;
        }
        if($request->image9){
            $data->image9 = $timestampNameImage9;
        }


        $data->cat = $request->get('cat');
        $data->category_id = $request->get('category_id');
        $data->assessmentUse = $request->get('assessmentUse');
        $data->assessmentSupport = $request->get('assessmentSupport');
        $data->linkSite = $request->get('linkSite');
        $data->linkCases = $request->get('linkCases');
        $data->linkInstructions = $request->get('linkInstructions');
        $data->linkVideo = $request->get('linkVideo');
        $data->linkAPI = $request->get('linkAPI');
        $data->methodsPay = $request->get('methodsPay');
        $data->systemInstall = $request->get('systemInstall');
        $data->professions = $request->get('professions');
        $data->socials = $request->get('socials');
        $data->isSupport = $request->get('isSupport');
        $data->linkCases = $request->get('linkCases');
        $data->linkAPI = $request->get('linkAPI');
        $data->linkInstructions = $request->get('linkInstructions');
        $data->save();
//        return $request->get('image1[1]');
        return response()->json('Сервис обновлен' . $request->get('image1'));
    }
    public function editService($id)
    {
        $service = Service::find($id);
        return response()->json($service);
    }
    public function remove($id) {
        Service::find($id)->remove();
    }
    public function updateService($id, Request $request)
    {
        $service = Service::find($id);
        $timestampNameLogo = '';
        if($request->logo && $request->logo !== $service->logo){
            if($service->logo){
                $service->removeImageLogo();
            }
            $extensionLogo = $request->logo->getClientOriginalExtension();
            $timestampNameLogo = microtime(true) . '.' . $extensionLogo;
            $request->logo->move(public_path('uploads/services'), $timestampNameLogo);
        }

        $timestampNameImage0 = '';
        if($request->image0 && $request->image0 !== $service->image0){
            if($service->image0){
                $service->removeImageID0();
            }
            $extensionImage0 = $request->image0->getClientOriginalExtension();
            $timestampNameImage0 = microtime(true) . '.' . $extensionImage0;
            $request->image0->move(public_path('uploads/services/items'), $timestampNameImage0);
        }
        $timestampNameImage1 = '';
        if($request->image1 && $request->image1 !== $service->image1){
            if($service->image1){
                $service->removeImageID1();
            }
            $extensionImage1 = $request->image1->getClientOriginalExtension();
            $timestampNameImage1 = microtime(true) . '.' . $extensionImage1;
            $request->image1->move(public_path('uploads/services/items'), $timestampNameImage1);
        }
        $timestampNameImage2 = '';
        if($request->image2 && $request->image2 !== $service->image2){
            if($service->image2){
                $service->removeImageID2();
            }
            $extensionImage2 = $request->image2->getClientOriginalExtension();
            $timestampNameImage2 = microtime(true) . '.' . $extensionImage2;
            $request->image2->move(public_path('uploads/services/items'), $timestampNameImage2);
        }
        $timestampNameImage3 = '';
        if($request->image3 && $request->image3 !== $service->image3){
            if($service->image3){
                $service->removeImageID3();
            }
            $extensionImage3 = $request->image3->getClientOriginalExtension();
            $timestampNameImage3 = microtime(true) . '.' . $extensionImage3;
            $request->image3->move(public_path('uploads/services/items'), $timestampNameImage3);
        }
        $timestampNameImage4 = '';
        if($request->image4 && $request->image4 !== $service->image4){
            if($service->image4){
                $service->removeImageID4();
            }
            $extensionImage4 = $request->image4->getClientOriginalExtension();
            $timestampNameImage4 = microtime(true) . '.' . $extensionImage4;
            $request->image4->move(public_path('uploads/services/items'), $timestampNameImage4);
        }
        $timestampNameImage5 = '';
        if($request->image5 && $request->image5 !== $service->image5){
            if($service->image5){
                $service->removeImageID5();
            }
            $extensionImage5 = $request->image5->getClientOriginalExtension();
            $timestampNameImage5 = microtime(true) . '.' . $extensionImage5;
            $request->image5->move(public_path('uploads/services/items'), $timestampNameImage5);
        }
        $timestampNameImage6 = '';
        if($request->image6 && $request->image6 !== $service->image6){
            if($service->image6){
                $service->removeImageID6();
            }
            $extensionImage6 = $request->image6->getClientOriginalExtension();
            $timestampNameImage6 = microtime(true) . '.' . $extensionImage6;
            $request->image6->move(public_path('uploads/services/items'), $timestampNameImage6);
        }
        $timestampNameImage7 = '';

        if($request->image7 && $request->image7 !== $service->image7){
            if($service->image7){
                $service->removeImageID7();
            }
            $extensionImage7 = $request->image7->getClientOriginalExtension();
            $timestampNameImage7 = microtime(true) . '.' . $extensionImage7;
            $request->image7->move(public_path('uploads/services/items'), $timestampNameImage7);
        }
        $timestampNameImage8 = '';
        if($request->image8 && $request->image8 !== $service->image8){
            if($service->image8){
                $service->removeImageID8();
            }
            $extensionImage8 = $request->image8->getClientOriginalExtension();
            $timestampNameImage8 = microtime(true) . '.' . $extensionImage8;
            $request->image8->move(public_path('uploads/services/items'), $timestampNameImage8);
        }

        $timestampNameImage9 = '';
        if($request->image9 && $request->image9 !== $service->image9){
            if($service->image9){
                $service->removeImageID9();
            }
            $extensionImage9 = $request->image9->getClientOriginalExtension();
            $timestampNameImage9 = microtime(true) . '.' . $extensionImage9;
            $request->image9->move(public_path('uploads/services/items'), $timestampNameImage9);
        }






        $service->update($request->all());
        $service->features = json_decode($request->get('features'));
        if($timestampNameLogo){$service->logo = $timestampNameLogo;}
        if($timestampNameImage0){$service->image0 = $timestampNameImage0;}
        if($timestampNameImage1){$service->image1 = $timestampNameImage1;}
        if($timestampNameImage2){$service->image2 = $timestampNameImage2;}
        if($timestampNameImage3){$service->image3 = $timestampNameImage3;}
        if($timestampNameImage4){$service->image4 = $timestampNameImage4;}
        if($timestampNameImage5){$service->image5 = $timestampNameImage5;}
        if($timestampNameImage6){$service->image6 = $timestampNameImage6;}
        if($timestampNameImage7){$service->image7 = $timestampNameImage7;}
        if($timestampNameImage8){$service->image8 = $timestampNameImage8;}
        if($timestampNameImage9){$service->image9 = $timestampNameImage9;}


        $service->save();
        return response()->json('Сервис обновлен');
    }
    public function changePublishService($id, Request $request)
    {
        $service = Service::find($id);
        $service->update($request->all());
        $service->save();
        return response()->json('Сервис обновлен' . $request);
    }

}
