<?php

namespace App\Http\Controllers\api;

use Illuminate\Http\Request;
use Illuminate\Support\Facades\DB;
use App\Http\Controllers\Controller;
use App\Review;

class ReviewsController extends Controller
{
     public function allSReviewsPag() {
            $data = Review::orderBy('id', 'desc')->paginate(10);
            return response()->json($data);
     }

    public function itemReviews($id) {
        $reviews = DB::table('reviews')->where([['service_id', $id],['is_publish',1]])->get();
        return response()->json($reviews);
    }

    public function createReviews(Request $request) {
        $data = new Review();
        $data->service_id = $request->get('service_id');
        $data->user_id = $request->get('user_id');
        $data->like_r = $request->get('like_r');
        $data->soc_icon = $request->get('soc_icon');
        $data->soc_link = $request->get('soc_link');
        $data->comment_all = $request->get('comment_all');
        $data->comment_minus = $request->get('comment_minus');
        $data->comment_plus = $request->get('comment_plus');
        $data->rating_use = $request->get('rating_use');
        $data->rating_support = $request->get('rating_support');
        $data->rating_quality = $request->get('rating_quality');
        $data->rating_features = $request->get('rating_features');
        $data->rating_recommendation = $request->get('rating_recommendation');
        $data->is_publish = $request->get('is_publish');
        $data->save();
        return $request;
    }

    public function getItemReview($id) {
        $review = Review::find($id);
        return response()->json($review);
    }

    public function updateReview($id, Request $request) {
        $review = Review::find($id);
        $review->like_users = $request->get('like_users');
        $review->update($request->all());
        return response()->json($request->all());
    }

    public function reviewDestroy($id) {
        $review = Review::find($id);
        $review->delete();
        return response()->json('successfully deleted');
    }
}
